# Pennsieve-cin App Security Headers
# Place this file at: public/_headers

/*
  # CONTENT SECURITY POLICY
  # Organized by service/purpose for easy maintenance

  Content-Security-Policy: default-src 'self';
    script-src 'unsafe-inline' 'unsafe-eval' 'wasm-unsafe-eval' 'self' data:
      https://js.pusher.com
      https://www.gstatic.com
      https://www.google.com/recaptcha/api.js
      https://www.googletagmanager.com
      https://www.google-analytics.com
      https://maps.googleapis.com
      https://cdn.polyfill.io
      https://polyfill.io
      https://bam.nr-data.net
      https://code.jquery.com
      https://cdnjs.cloudflare.com
      https://stackpath.bootstrapcdn.com
      https://use.fontawesome.com;
    style-src 'unsafe-inline' 'self'
      https://fonts.googleapis.com
      https://api.tiles.mapbox.com
      https://stackpath.bootstrapcdn.com;
    img-src 'self' data: blob:
      https://pennsieve-clin-prod-dataset-assets-use1.s3.amazonaws.com
      https://pennsieve-clin-prod-dataset-assets-use1.s3.us-east-1.amazonaws.com
      https://pennsieve-clin-prod-storage-use1.s3.amazonaws.com
      https://pennsieve-clin-prod-uploads-use1.s3.us-east-1.amazonaws.com
      https://prod-rejoin-storage-use1.s3.amazonaws.com
      https://prod-precision-storage-use1.s3.amazonaws.com
      https://prd-sparc-storage-use1.s3.amazonaws.com
      https://api.pennsieve.org
      https://api2.pennsieve.org
      https://assets.discover.pennsieve.org
      https://stats.g.doubleclick.net
      https://maps.gstatic.com
      https://www.google-analytics.com
      https://heapanalytics.com
      http://gravatar.com
      https://static.intercomassets.com
      https://downloads.intercomcdn.com
      https://uploads.intercomusercontent.com;
    font-src 'self' data: blob:
      https://fonts.gstatic.com;
    media-src 'self' blob:
      https://pennsieve-clin-prod-storage-use1.s3.amazonaws.com
      https://pennsieve-clin-prod-uploads-use1.s3.us-east-1.amazonaws.com
      https://prod-rejoin-storage-use1.s3.amazonaws.com
      https://prod-precision-storage-use1.s3.amazonaws.com
      https://prd-sparc-storage-use1.s3.amazonaws.com
      https://api.pennsieve.org
      https://api2.pennsieve.org;
    frame-src 'self'
      https://www.google.com
      https://api.pennsieve.org
      https://api2.pennsieve.org
      https://pennsieve-clin-prod-storage-use1.s3.amazonaws.com
      https://pennsieve-clin-prod-uploads-use1.s3.us-east-1.amazonaws.com
      https://prod-rejoin-storage-use1.s3.amazonaws.com
      https://prod-precision-storage-use1.s3.amazonaws.com
      https://prd-sparc-storage-use1.s3.amazonaws.com;
    worker-src 'self' blob:
      https://www.youtube.com
      https://player.vimeo.com
      https://fast.wistia.net;
    connect-src 'self'
      wss://*.pusher.com
      https://*.pusher.com
      *.pusherapp.com
      https://pub.sandbox.orcid.org
      https://pub.orcid.org
      https://citation.crosscite.org
      https://data.datacite.org
      https://doi.org
      https://www.google-analytics.com
      https://pennsieve-clin-prod-uploads-use1.s3.amazonaws.com
      https://pennsieve-clin-prod-uploads-use1.s3.us-east-1.amazonaws.com
      https://pennsieve-clin-prod-storage-use1.s3.amazonaws.com
      https://pennsieve-clin-prod-dataset-assets-use1.s3.amazonaws.com
      https://pennsieve-clin-prod-dataset-assets-use1.s3.us-east-1.amazonaws.com
      https://prod-rejoin-storage-use1.s3.amazonaws.com
      https://prod-precision-storage-use1.s3.amazonaws.com
      https://prd-sparc-storage-use1.s3.amazonaws.com
      https://bam.nr-data.net
      https://app.getsentry.com
      https://maps.tilehosting.com
      https://api.maptiler.com
      wss://notifications.pennsieve.org
      https://streaming.pennsieve.org
      wss://streaming.pennsieve.org
      wss://api.pennsieve.org
      https://api.pennsieve.org
      https://api2.pennsieve.org
      https://admin.api.pennsieve.org
      https://concepts.pennsieve.org
      https://s3.amazonaws.com
      https://discover.pennsieve.org;
    object-src 'self';
    frame-ancestors 'none';
    base-uri 'self';
    form-action 'self'

  # SECURITY HEADERS
  X-Frame-Options: DENY
  X-Content-Type-Options: nosniff
  X-XSS-Protection: 1; mode=block
  Referrer-Policy: strict-origin-when-cross-origin
  Permissions-Policy: camera=(), microphone=(), geolocation=(), payment=()
  Strict-Transport-Security: max-age=31536000; includeSubDomains

# STATIC ASSETS - Optimized for performance
/assets/*
  Content-Security-Policy: default-src 'self'; img-src 'self' data: https:; style-src 'self' 'unsafe-inline'
  Cache-Control: public, max-age=31536000, immutable